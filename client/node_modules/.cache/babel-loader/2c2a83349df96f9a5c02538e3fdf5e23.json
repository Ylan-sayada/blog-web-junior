{"ast":null,"code":"import _regeneratorRuntime from\"/home/ilan/Documents/Developement/Mes_projets/BlogWebJunior/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/ilan/Documents/Developement/Mes_projets/BlogWebJunior/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/ilan/Documents/Developement/Mes_projets/BlogWebJunior/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ilan/Documents/Developement/Mes_projets/BlogWebJunior/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import MessageForm from'../../vendorComponents/materialUi/input/MessageForm';import FineSep from'../sep/FineSep';import AddIcon from'@material-ui/icons/Add';import ExtendedBtn from'../buttons/ExtendedBtn';import{CircularProgress}from'@material-ui/core';import{ReactComponent as SendPost}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../../ressources/img/sendPost.svg\";import Comments from'./Comments';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function MessageInterface(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),comments=_useState2[0],setComments=_useState2[1];var _useState3=useState(3),_useState4=_slicedToArray(_useState3,2),currentIndex=_useState4[0],setCurrentIndex=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),numOfArticle=_useState6[0],setnumOfArticle=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),hasPosted=_useState8[0],setHasposted=_useState8[1];var handlePostMessage=function handlePostMessage(posted){setHasposted(posted);setnumOfArticle(numOfArticle+1);};var addMsgToDisplay=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id,currentIndex){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/api/comments/\".concat(id,\"/\").concat(currentIndex,\"/3\")).then(function(res){setCurrentIndex(currentIndex+3);var arrData=res.data.map(function(el){return{author:el.name,date:el.date,msg:el.text};});setComments(function(previous){return[].concat(_toConsumableArray(previous),_toConsumableArray(arrData));});}).catch(function(error){console.log(error);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function addMsgToDisplay(_x,_x2){return _ref.apply(this,arguments);};}();useEffect(function(){var getFirstMsg=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(\"/api/comments/\".concat(id,\"/0/3\")).then(function(res){return res;}).catch(function(error){console.log(error);});case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function getFirstMsg(_x3){return _ref2.apply(this,arguments);};}();getFirstMsg(props.id).then(function(result){var orderList=result.data[1].map(function(el){return{author:el.name,date:el.date,msg:el.text};});setComments(orderList);setnumOfArticle(result.data[0]);});},[props.id,hasPosted]);return/*#__PURE__*/_jsxs(\"div\",{className:\"message-interface\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u05D4\\u05D5\\u05E1\\u05E3 \\u05EA\\u05D2\\u05D5\\u05D1\\u05D4\"}),hasPosted?/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"space-evenly\",fontSize:\"1.2rem\",padding:\"20px\"},children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u05D4\\u05EA\\u05D2\\u05D5\\u05D1\\u05D4 \\u05E0\\u05E9\\u05DC\\u05D7\\u05D4 \\u05D1\\u05D4\\u05E6\\u05DC\\u05D7\\u05D4! \"}),/*#__PURE__*/_jsx(SendPost,{})]}):/*#__PURE__*/_jsx(MessageForm,{postState:handlePostMessage,id:props.id,action:\"/api/comments/\"}),/*#__PURE__*/_jsx(FineSep,{dashed:true}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"\\u05EA\\u05D2\\u05D5\\u05D1\\u05D5\\u05EA (\",numOfArticle,\")  \"]}),!comments?/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"center\",padding:\"20px 0\"},children:/*#__PURE__*/_jsx(CircularProgress,{})}):comments.map(function(comment,index){switch(index){case 0:return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(Comments,{comments:comment})},index);case comments.length-1:return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(FineSep,{}),/*#__PURE__*/_jsx(Comments,{comments:comment})]},index);default:return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(Comments,{comments:comment}),/*#__PURE__*/_jsx(FineSep,{})]},index);}}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center'},children:numOfArticle>comments.length&&/*#__PURE__*/_jsxs(ExtendedBtn,{onClick:function onClick(){return addMsgToDisplay(props.id,currentIndex);},customStyle:{backgroundColor:'#03a9f4',color:'#fff',margin:\"20px 0\"},children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u05D4\\u05E6\\u05D2 \\u05E2\\u05D5\\u05D3\"}),/*#__PURE__*/_jsx(AddIcon,{})]})})]});}export default/*#__PURE__*/React.memo(MessageInterface);","map":{"version":3,"sources":["/home/ilan/Documents/Developement/Mes_projets/BlogWebJunior/client/src/common/components/ect/MessageInterface.tsx"],"names":["React","useEffect","useState","MessageForm","FineSep","AddIcon","ExtendedBtn","CircularProgress","Comments","axios","MessageInterface","props","comments","setComments","currentIndex","setCurrentIndex","numOfArticle","setnumOfArticle","hasPosted","setHasposted","handlePostMessage","posted","addMsgToDisplay","id","get","then","res","arrData","data","map","el","author","name","date","msg","text","previous","catch","error","console","log","getFirstMsg","result","orderList","display","alignItems","justifyContent","fontSize","padding","comment","index","length","backgroundColor","color","margin","memo"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport MessageForm from '../../vendorComponents/materialUi/input/MessageForm'\nimport FineSep from '../sep/FineSep';\nimport AddIcon from '@material-ui/icons/Add';\nimport ExtendedBtn from '../buttons/ExtendedBtn';\nimport { CircularProgress } from '@material-ui/core';\nimport { ReactComponent as SendPost } from '../../../ressources/img/sendPost.svg';\nimport Comments from './Comments';\nimport axios from 'axios';\n\n\nfunction MessageInterface(props: { id: string }) {\n    let [comments, setComments] = useState<any[]>([]);\n    let [currentIndex, setCurrentIndex] = useState(3);\n    let [numOfArticle, setnumOfArticle] = useState(0);\n    let [hasPosted, setHasposted] = useState(false);\n    let handlePostMessage = (posted: boolean) => {\n        setHasposted(posted);\n        setnumOfArticle(numOfArticle + 1);\n    }\n    let addMsgToDisplay = async (id: string, currentIndex: number) => {\n        await axios.get(`/api/comments/${id}/${currentIndex}/3`)\n            .then((res) => {\n                setCurrentIndex(currentIndex + 3);\n                let arrData = res.data.map((el: any) => {\n                    return { author: el.name, date: el.date, msg: el.text };\n                })\n                setComments((previous) => [...previous, ...arrData])\n\n            })\n            .catch(function (error) {\n                console.log(error);\n            })\n    }\n    useEffect(() => {\n        let getFirstMsg = async (id?: string) => {\n            return await axios.get(`/api/comments/${id}/0/3`)\n                .then((res) => {\n                    return res;\n                })\n                .catch(function (error) {\n                    console.log(error);\n                })\n        }\n        getFirstMsg(props.id)\n            .then((result: any) => {\n                let orderList = result.data[1].map((el: any) => {\n                    return { author: el.name, date: el.date, msg: el.text };\n                });\n                setComments(orderList);\n                setnumOfArticle(result.data[0]);\n            });\n    }, [props.id, hasPosted]);\n\n    return (\n        <div className=\"message-interface\">\n            <h3>הוסף תגובה</h3>\n            {hasPosted ? <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-evenly\", fontSize: \"1.2rem\", padding: \"20px\" }}><span>התגובה נשלחה בהצלחה! </span><SendPost /></div> :\n                <MessageForm postState={handlePostMessage} id={props.id} action=\"/api/comments/\" />}\n            <FineSep dashed />\n            <h3>תגובות ({numOfArticle})  </h3>\n\n            {!comments ? <div style={{ display: \"flex\", justifyContent: \"center\", padding: \"20px 0\" }}><CircularProgress /></div>\n                :\n                comments.map((comment, index) => {\n                    switch (index) {\n                        case 0:\n                            return (<React.Fragment key={index}><Comments comments={comment} /></React.Fragment>)\n                        case (comments.length - 1):\n                            return (<React.Fragment key={index}><FineSep /><Comments comments={comment} /></React.Fragment>)\n                        default:\n                            return <React.Fragment key={index}><Comments comments={comment} /><FineSep /></React.Fragment>\n                    }\n                })}\n            <div style={{\n                display: 'flex', justifyContent: 'center'\n            }}>\n                {numOfArticle > comments.length &&\n                    <ExtendedBtn\n                        onClick={() => addMsgToDisplay(props.id, currentIndex)}\n                        customStyle={{ backgroundColor: '#03a9f4', color: '#fff', margin: \"20px 0\" }}\n                    >\n                        <span>הצג עוד</span>\n                        <AddIcon />\n                    </ExtendedBtn>\n                }\n            </div >\n        </div >\n    )\n\n}\nexport default React.memo(MessageInterface);\n"]},"metadata":{},"sourceType":"module"}